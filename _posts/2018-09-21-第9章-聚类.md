---
layout:     post   					# 使用的布局（不需要改）
title:      第九章 聚类				# 标题 
subtitle:                            			# 副标题
date:       2018-09-21				# 时间
author:     RavenZhao	 			# 作者
header-img: img/post-bg-2015.jpg 	# 这篇文章标题背景图片
catalog: true 						# 是否归档
tags:							# 标签
    - 机器学习
    - 笔记
---

# 第九章 聚类

### 9.1 聚类任务

- 无监督学习（unsupervised learning）中，训练样本的标记信息未知。
  - 目的：通过对无标记训练样本的学习来揭示数据的内在性质及规律
- 聚类：试图将数据集中的样本划分为若干个通常是不想交的子集。
  - 每个子集称为一个“簇”。
  - 每个簇可能对应于一些潜在的概念类别。对于聚类算法而言事先是未知的。
- 假定样本集$D=\{(x_1,x_2,...,x_m)\}$包含$m$个无标记样本，每个样本$x_i=(x_{i1};x_{i2};…;x_{im})$是一个$n$维特征向量，聚类算法将样本集$D$划分为$k$个不想交的簇$\{C_l\mid l=1,2,...,k\}$，其中$C_{l’}\bigcap_{l’\neq l}C_l=\emptyset$，且$D=\bigcup_{l=1}^kC_l$。相应地，我们用$\lambda_j\in\{1,2,...,k\}$表示样本$x_j$的“簇标记”（cluster label），即$x_i\in C_{\lambda_j}$。聚类的结果可以用包含$m$个元素的簇标记向量$\lambda=(\lambda_1;\lambda_2;...;\lambda_m)$表示。
- 聚类既能作为一个**单独过程**，用于找寻数据内在的分布结构，也可作为分类等其他学习任务的**前驱过程**。

### 9.2 性能度量

- 聚类性能度量亦称“有效性指标”（validity index）。
- 聚类结果的“簇内相似度”（intra-cluster similarity）高且“簇间相似度”（inter-cluster similarity）低
- 聚类性能度量大致分两类：
  - 将聚类结果与某个“参考模型”（reference model）进行比较，称为“外部指标”（external index）
  - 直接考察聚类结果而不利用任何参考模型，称为“内部指标”（internal index）
- 对数据集$D=\{x_1,x_2,...,x_m\}$，假定通过聚类给出的簇划分为$C=\{C_1,C_2,...,C_k\}$，参考模型给出的划分簇划分为$C^{\ast}=\{C_1^{\ast},C_2^{\ast},...,C_s^{\ast}\}$。相应地，令$\lambda$与$\lambda^{\ast}$分别表示与$C$和$C^{\ast}$对应的簇标记向量。将样本两两配对考虑。定义：
  - $a=\lvert SS\rvert,SS=\{(x_i,x_j)\mid\lambda_i=\lambda_j,\lambda_i^{\ast}=\lambda_j^{\ast};i<j\}$
  - $b=\mid SD\mid,SD=\{(x_i,x_j)\mid\lambda_i=\lambda_j,\lambda_i^{\ast}\neq\lambda_j^{\ast};i<j\}$
  - $c=\lvert DS\rvert,DS=\{(x_i,x_j)\mid\lambda_i\neq\lambda_j,\lambda_i^{\ast}=\lambda_j^{\ast};i<j\}$
  - $d=\lvert DD\rvert,DD=\{(x_i,x_j)\mid\lambda_i\neq\lambda_j,\lambda_i^{\ast}\neq\lambda_j^{\ast};i<j\}$
  - 其中集合$SS$包含了在$C$中隶属于相同簇且在$C^\ast$中也隶属于相同簇的样本对，集合$SD$包含了在$C$中隶属于相同簇但在$C^\ast$中隶属于不同簇的样本对。
  - 每个样本对$(x_i,x_j)(i<j)$仅能出现在一个集合中，因此$a+b+c+d=m(m-1)/2$
- 常用的聚类性能度量外部指标：[0,1]之间，越大越好

| Jaccard系数（Jaccard Coefficient）  | $JC=\frac{a}{a+b+c}$                     |
| ----------------------------------- | ---------------------------------------- |
| FM指数（Fowlkes and Mallows Index） | $FMI=\sqrt{\frac{a}{a+b}·\frac{a}{a+c}}$ |
| Rand指数（Rand Index）              | $RI=\frac{2(a+d)}{m(m-1)}$               |

- 考虑聚类结果的簇内划分$C=\{C_1,C_2,...,C_k\}$，定义：
  - $avg(C)=\frac2{\lvert C\rvert(\lvert C\rvert-1)}\sum_{1\leq i<j\leq\lvert C\rvert}dist(x_i,x_j)$
    - 对应于簇$C$内样本间的平均距离
  - $diam(C)=max_{1\leq i<j\leq\lvert C\rvert}dist(x_i,x_j)$
    - 对应于簇$C$内样本间的最远距离
  - $d_{min}(C_i,C_j)=min_{x_i\in C_i,x_j\in C_j}dist(x_i,x_j)$
    - 对应于簇$C_i$与簇$C_j$最近样本间的距离
  - $d_{cen}(C_i,C_j)=dist(\mu_i,\mu_j)$
    - $d_{cen}(C_i,C_j)$对应于簇$C_i$与簇$C_j$中心点的距离
    - $dist(·,·)$用于计算两个样本样本之间的距离；
    - $\mu$代表簇$C$的中心点$\mu=\frac1{\lvert C\rvert}\sum_{1\leq i\leq \lvert C\rvert}x_i$ 
- 常用的聚类性能度量内部指标

| DB指数（Davies-Bouldin Index） | $DBI=\frac1k\sum_{j\neq i}^k\mathop{max}\limits_{j\neq i}(\frac{avg(C_i)+avg(C_j)}{d_{cen}(\mu_i,\mu_j)})$ | 越小越好 |
| ------------------------------ | ------------------------------------------------------------ | -------- |
| Dunn指数（Dunn Index）         | $DI=\mathop{min}\limits_{1\leq i\leq k}\{\mathop{min}\limits_{j\neq i}(\frac{d_{min}(C_i,C_j)}{max_{1\leq l\leq k}diam(C_l)})\}$ | 越大越好 |

### 9.3 距离计算

- 对函数$dist(·,·)$，如果它是一个“距离度量”(distance measure)，则满足一些基本性质：
  - 非负性：$dist(x_i,x_j)\geq 0$
  - 同一性：$dist(x_i,x_j)=0$，当且仅当$x_i=x_j$
  - 对称性：$dist(x_i,x_j)=dist(x_j,x_i)$
  - 直递性：$dist(x_i,x_j)\leq dist(x_i,x_k)+dist(x_k,x_j)$
- 给定样本$x_i=(x_{i1},x_{i2},...,x_{in})$与$x_j=(x_{j1},x_{j2},...,x_{jn})$，最常用的是“闵可夫斯基距离”（Minkowski distance）：$dist_{mk}(x_i,x_j)=(\sum_{u=1}^n\m<span class="">id</span> x_{iu}-x_{ju}\m<span class="">id</span>^p)^{\frac1p}$
  - 对$p\geq 1$，上式满足基本性质；
  - $p=2$时，闵可夫斯基距离即欧氏距离（Euclidean distance）：$dist_{ed}(x_i,x_j)=\lVert x_i-x_j\rVert_2=\sqrt{\sum_{u=1}^n\lvert x_{iu}-x_{ju}\rvert^2}$
  - $p=1$时，闵可夫斯基距离即曼哈顿距离（Manhattan distance）：$dist_{man}(x_i,x_j)=\lVert x_i-x_j\rVert_1=\sum_{u=1}^n\lvert x_{iu}-x_{ju}\rvert$
- 属性分类：
  - 连续属性（continuous attribute）：在定义域上有无穷多个取值
  - 离散属性（categorical attribute）：在定义域上有限个取值
- 有序属性
  - 可以用闵可夫斯基距离
- 无序属性
  - VDM（Value Difference Metric）。
- 将闵可夫斯基距离和VDM结合可以处理混合属性。
- 通常基于某种形式的距离来定义“相似度度量”（similarity measure）
  - 距离越大，相似度越小。
  - 用于相似度度量的距离未必一定满足距离度量的所有基本属性。（尤其是直递性）
  - 不满足直递性的距离称为“非度量距离”（non-metric distance）